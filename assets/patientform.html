<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Muzima Patient Form</title>
    <link rel="stylesheet" style="text/css" href="deps/opt/bootstrap.css" />
    <script>
function load()
{
alert("Page is loaded");
}
</script>



  </head>
  <body onload="load()">
    <h1>Muzima Patient Form </h1>
    <form></form>
    <div id="res" class="alert"></div>
    <script type="text/javascript" src="deps/jquery.min.js"></script>
    <script type="text/javascript" src="deps/underscore.js"></script>
   
    <script type="text/javascript" src="lib/jsonform.js"></script>
    <script type="text/javascript">
    var uuidGlobal;

    function setPersonUUID(patientUuid){
    	alert("Getting uuid: " + patientUuid);
    	uuidGlobal=patientUuid;
    	alert("person uuid: " + uuidGlobal);
    	console.log("uuid globalis" + uuidGlobal);
    	
    }


      $('form').jsonForm({
        schema: {
          datasource: {
            type: 'string',
            title: 'Datasource',
	        default:'a261d8ce-08e6-4fee-b0a5-e0c3f3a0dca6'
            
          },
          discriminator: {
            type: 'string',
            title: 'Discriminator',
			default:'encounter'
          },
		  payload:{
		  type:'object',
		  title:'Payload',
		  properties:{
		 personuuid:{
				title:'Persounuuid',
				type:'string'
				
					
		  
		  },
		  obs: {
						"type": "array",
						title:'Observation',
						
						"items": [
                {
                    "type": "object",
                    "properties": {
                        name: {
                            "type": "string",
                            "title": "Question",
                            "default": "Appearance Of Specimen"
                        },
                        code: {
                            "type": "integer",
                            "title": "Coded Question",
                            "default": 1114
                        },
                        value: {
                            "type": "string",
                            "title": "Value",
							default:'1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
                        },
                        type: {
                            "type": "string",
                            "title": "Type",
                            "default": "coded"
                        },
                        datetime: {
                            "type": "string",
                            "title": "Observation Date"
                        }
                    }
                },
                {
                    type: "object",
                    "properties": {
                        name: {
                            "type": "string",
                            "title": "Question",
                            "default": "Sputum Fast Acid Bascilli"
                        },
                        code: {
                            "type": "integer",
                            "title": "Coded Question",
                            "default": 1115
                        },
                        value: {
                            "type": "string",
                            "title": "Value"
							
                        },
                        type: {
                            "type": "string",
                            "title": "Type",
                            "default": "coded"
                        },
                        datetime: {
                            "type": "string",
                            "title": "Observation Date"
                        }
                    }
                }
            ]
        },
		encounter: {
            type: 'object',
            title: 'Encounter',
            properties: {
                
				form_uuid:{
				type: 'string',
				title: 'Formuuid',
				default:'fe9fc58f-d196-46cb-956d-f46445f558d9'
				},
				
				datetime: {
                    "type": "string",
                    "title": "Encounter Date",
                    "maxLength": 20,
					default:'2012-12-19 08:05:09'
                },
                "location_uuid": {
                    "type": "string",
                    "title": "Encounter Location",
					default:'8d5b2be0-c2cc-11de-8d13-0010c6dffd0f'
                },
                "provider_uuid": {
                    "type": "string",
                    "title": "Encounter Provider",
					default:'842f4bae-1692-11df-97a5-7038c432aabf'
					
                },
				encounter_type:{
				type:'string',
				title:'Encountertype',
				enum:['LabVisit','Dr','Other']
				}
            }
        },
		

        }}},value: {
            // datasource: 'a261d8ce-08e6-4fee-b0a5-e0c3f3a0dca6',
            // discriminator: 'encounter',
            payload: {
              personuuid: uuidGlobal //,
            //   obs: [
            //     {
            //       name  : 'Appearance Of Specimen',
            //       code  : 1114,
            //       value : '1364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA',
            //       type  :'coded'
            //     },
            //     {
            //       name : 'Sputum Fast Acid Bascilli',
            //       code : 1115,
            //       type : 'coded'
            //     }
            //   ],
            //   encounter: {
            //     form_uuid     : 'fe9fc58f-d196-46cb-956d-f46445f558d9',
            //     datetime      : '2012-12-19 08:05:09',
            //     location_uuid : '8d5b2be0-c2cc-11de-8d13-0010c6dffd0f',
            //     provider_uuid : '842f4bae-1692-11df-97a5-7038c432aabf'
            //   }
            }
          },
        
		
 
		
        onSubmit: function (errors, values) {
        	 if (errors) {
                 $('#res').html('<p>check Form fields?? Openmrs</p>');
               }
               else {
     		  if (console && console.log) {
                 console.log('Values extracted from submitted form', values);
             }

     		  
                 
               }
     		  
     		   alert('Form submitted. Values object:\n' + JSON.stringify(values, null, 2));
     		   jsonObj = JSON.stringify(values, null, 2); 
     		   android.TestMethod(jsonObj); 
        },
        onSubmitValid: function (values) {
            // "values" follows the schema, yeepee!
            console.log(values);
          },
		
      });
    </script>
    <script type="text/javascript">
	 
	 function onSubmit(){  
      
     var jsonObj = JSON.stringify(values, null, 2);  
     /* NOTE: Calling Activity Method using the Activity defined 
        instance "android" in JavaScript */
     android.TestMethod(jsonObj); }
	
				</script>
				   
      
     
				
    <li><a href="navbar.html"rel="external">Back</a></li>
  </body>
</html>